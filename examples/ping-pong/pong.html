<!doctype html><title>Pong (Plink)</title>
<script src="/plink.js"></script>
<script>
	var link = Plink.create().connect('ws://' + location.hostname + ':20500/');

	link.on('open', function(){
		link.useToken('ozan').then(function(peer){
			// When the connection opens, send an initial ping
			// to start the dialog
			peer.on('open', function(){
				console.log('connected to peer at ' + peer.address);
				peer.send('ping?');
				console.log(peer.address, ' <-- ', 'ping?');
			});

			// Whenever we receive a response from the peer,
			// wait one second and respond with another ping.
			peer.on('message', function(message){
				console.log(peer.address, ' --> ', message);

				setTimeout(function(){
					peer.send('ping?');
					console.log(peer.address, ' <-- ', 'ping?');
				}, 1000);
			});
		});
	});
</script>